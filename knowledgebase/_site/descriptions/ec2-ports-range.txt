ec2-ports-range
  description "Security group specifies a port range rather than individual ports."
  suggested_action "Only add rules to your Security group that specify individual ports and don't use port ranges unless they are required."

"A security group acts as a virtual firewall for your instance to control inbound and outbound traffic. For each security group, you add rules that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic. For each security group, you add rules that control the inbound traffic to instances, and a separate set of rules that control the outbound traffic.
The following are the basic parts of a security group rule:
(Inbound rules only) The source of the traffic (CIDR range or security group) and the destination port or port range.
(Outbound rules only) The destination for the traffic (CIDR range or security group) and the destination port or port range.
Any protocol that has a standard protocol number."
http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_SecurityGroups.html

It is the best practice to specify specific ports versus a range of ports. When specifying a range of ports, there is the potential to open more ports than is necessary for your application, which can introduce security vulnerabilities into your environment.

Suggested Action:
When creating or modifying your security groups, only add rules to your Security group that specify individual ports and don't use port ranges unless they are required.


coreo_aws_advisor_alert "ec2-ports-range" do
  action :define
  service :ec2
  description "security group specifies a port range rather than individual ports"
  category "vulnerablity"
  suggested_action ""
  level "warning"
  objectives ["security_groups"]
  audit_objects ["security_group_info.ip_permissions.from_port"]
  operators ["!="]
  alert_when ["object[:to_port]"]
end
