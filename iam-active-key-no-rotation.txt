Active key no rotation
  description "User has ACTIVE keys that have not been rotated in the last 90 days"
  suggested_action "rotate the keypairs"

“Rotating Access Keys
As a security best practice, we recommend that you, an administrator, regularly rotate (change) the access keys for IAM users in your account. If your users have the necessary permissions, they can rotate their own access keys. For information about how to give your users permissions to rotate their own access keys, see Allow Users to Manage Their Own Passwords, Access Keys, and SSH Keys.
http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_delegate-permissions_examples.html#creds-policies-credentials

You can also apply a password policy to your account to require that all of your IAM users periodically rotate their passwords,. You can choose how often they must do so. For more information, see Setting an Account Password Policy for IAM Users.
http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html

Important
If you regularly use the AWS root account credentials, we recommend that you also regularly rotate them. The account password policy does not apply to the AWS root account credentials. IAM users cannot manage credentials for the AWS root account, so you must use the AWS root account's credentials (not a user's) to change the AWS root account credentials. Note that we recommend against using the AWS root account for everyday work in AWS.”
http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html#Using_RotateAccessKey

Suggested Action:
Rotate your keypairs regularly.
Or consider using Amazon's Key Management Service - http://docs.aws.amazon.com/kms/latest/developerguide/overview.html

How to rotate access keys for IAM users
https://blogs.aws.amazon.com/security/post/Tx15CIT22V4J8RP/How-to-rotate-access-keys-for-IAM-users

Additional information:
The National Institute of Standards and Technology provides definitions of appropriate key lengths and provides guidelines for how long keys should be used.
http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r4.pdf

Code used for this alert - keep in this text file for a while
coreo_aws_advisor_alert "active-key-no-rotation" do
  action :define
  service :iam
  description "User has ACTIVE keys that have not been rotated in the last 90 days"
  category "danger"
  suggested_action "rotate the keypairs"
  level "medium"
  objectives ["access_keys", "access_keys"]
  audit_objects ["access_key_metadata.create_date","access_key_metadata.status"]
  operators [">", "=="]
  alert_when ["90.days.ago", "Active"]
end
