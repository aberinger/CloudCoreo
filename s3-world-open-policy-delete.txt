coreo_aws_advisor_alert "world-open-policy-delete" do
  action :define
  service :s3
  description "Bucket can be deleted by the world"
  category "dataloss"
  suggested_action "fix it"
  level "danger"
  objectives ["bucket_policy"]
  audit_objects ["policy"]
  formulas ["jmespath.Statement[*].[Effect,Principal,Action]"]
  operators ["=~"]
  alert_when [/"Allow",[^\]]+("AWS":"*"|"*")[^\]]+(s3:DeleteBucket)/]
end
