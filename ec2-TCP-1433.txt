TCP 1433
  description "security group is unused"
  suggested_action "delete the group"

"In order to prevent [unauthorized users] from gaining privileged access to your virtual server and planting malware or stealing data, you need to make sure that important ports/protocols are only accessible by trusted IP addresses and networks. For example, remote administration ports like 22 (SSH) and 3389 (RDP) should only allow access from your private network or bastion hosts, and not the entire Internet (which is specified in security groups as 0.0.0.0/0).In addition to remote administration ports 22 and 3389, there are several other ports that allow privileged or database access. Make sure you restrict these ports to IPs or subnets you trust, and don't allow public Internet access (0.0.0.0/0) to them. Here is a list of [some of the] common ports you should consider locking down: 20/21 - FTP, 22 - SSH, 23 - Telnet, 1433 - MSSQL Server, 1434 - MSSQL Monitor, 1521 - Oracle database, 3389 - RDP, 3306 - MySQL, 3389 - Microsoft Terminal Server (RDP), 4333 - MSQL, 5432 - PostgreSQL, 5500 - VNC RDP, 27017 - MongoDB.
https://aws.amazon.com/articles/1233/

Suggested action:
Security Groups can be used to secure ports over TCP, UDP, and ICMP protocols. We recommend that you open only those ports that must be open for your service to operate." Consider deleting the affected security group.
https://aws.amazon.com/articles/1233/


coreo_aws_advisor_alert "TCP-1433-0.0.0.0/0" do
  action :define
  service :ec2
  description "security group is unused"
  category "vulnerablity"
  suggested_action "delete the group"
  level "warning"
  objectives ["","","security_groups"]
  audit_objects ["security_group_info.ip_permissions.ip_protocol", "security_group_info.ip_permissions.from_port", "security_group_info.ip_permissions.ip_ranges.cidr_ip"]
  operators ["==","==","=="]
  alert_when ["tcp", 1433, "0.0.0.0/0"]
end
