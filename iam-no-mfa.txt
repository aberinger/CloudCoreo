No mfa
  description "Cloud user does not have Multi-Factor Authentication enabled on their cloud account"
  suggested_action "Enable Multi-Factor Authentication for every cloud user"

"Multi-Factor Authentication (MFA) is a simple best practice that adds an extra layer of protection on top of your user name and password. With MFA enabled, when a user signs in, they will be prompted for their user name and password (the first factor—what they know), as well as for an authentication code from their MFA device (the second factor—what they have). Taken together, these multiple factors provide increased security for your account settings and resources. You can enable MFA for your account and for individual  users you have created under your account. MFA can be also be used to control access to service APIs."
https://aws.amazon.com/iam/details/mfa/

"A virtual MFA device uses a software application to generate a six-digit authentication code that is compatible with the time-based one-time password (TOTP) standard, as described in RFC 6238. The app can run on mobile hardware devices, including smartphones. With most virtual MFA applications, you can host more than one virtual MFA device, which makes them more convenient than hardware MFA devices."
http://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_virtual.html

coreo_aws_advisor_alert "no-mfa" do
  action :define
  service :iam
  description "User does not have MFA enabled"
  category "warning"
  suggested_action "Find the user and have him/her enable an MFA device"
  level "medium"
  id_map "modifiers.user_name"
  objectives ["users", "mfa_devices"]
  formulas ["count", ""]
  call_modifiers [{}, { :user_name => "users.user_name" }]
  audit_objects ["", "object.mfa_devices"]
  operators ["", "<"]
  alert_when ["", 1]
end
